'use strict';
/*
imageswipe v. 1.0.0
fedeghe <fedeghe@gmail.com>
~2.62KB
*/
!function(e){function t(e,t,i){Object.entries(i).forEach(function(i){e[t][i[0]]=i[1]})}function i(e,i,n){function a(){!--d&&n()}function s(e,i,n){e.onload=a,e.src=i,t(e,"style",{position:"absolute",top:0,left:0,zIndex:n}),e.setAttribute("draggable","false"),o.appendChild(e)}var o=document.createElement("div"),r=new Image,p=new Image,d=2;return s(r,e.image0src,0),s(p,e.image1src,0),i.style.position="relative",i.appendChild(o),p}function n(t){var i=this;this.opts=t||{imageSwipe:!0,rangeSwipe:!0},this.els=[],this.range=null,this.separator=null,e.addEventListener("load",i.getItems.bind(i))}var a=e.document;n.prototype.getItems=function(){var e=this,t=a.querySelectorAll("[data-imageswipe]"),n=t.length;t.forEach(function(t){var a=t.dataset.imageswipe.split(";"),s={range:{value:0},separator:null,container:null,node:t,image0src:a[0],image1src:a[1]};s.mainImg=i(s,s.node,function(){s.node.style.visibility="hidden",s.node.style.height=s.mainImg.height+(e.opts.rangeSwipe?30:0)+"px",s.size={width:s.mainImg.width,height:s.mainImg.height},s.mainImg.style.clip="rect(0, 0px, "+s.mainImg.height+"px, 0)",0===--n&&e.init()}),s.container=s.mainImg.parentNode,t.removeAttribute("data-imageswipe"),e.els.push(s)})},n.prototype.init=function(){var e=this;this.els.forEach(function(i){function n(e){i.separator.style.opacity=1,i.mainImg.style.clip="rect(0, "+e+"px, "+i.size.height+"px, 0)",i.separator.style.left=e+"px",i.range.value=e,(e<2||e>i.size.width-2)&&(i.separator.style.opacity=0)}function a(e,t){var i=Math.abs(e.offsetX);t&&n(i)}function s(){i.container.style.cursor="ew-resize",i.sliding=!0}function o(){i.container.style.cursor="default",i.sliding=!1}i.node.style.visibility="visible",i.separator=document.createElement("div"),t(i.separator,"style",{pointerEvents:"none",position:"absolute",width:0,border:"0.5px dashed rgba(0, 0, 0, .2)",height:i.size.height+"px",top:"0px"}),e.opts.rangeSwipe&&(i.range=document.createElement("input"),i.range.type="range",t(i.range,"style",{padding:0,margin:0,marginTop:"5px",position:"absolute",width:i.size.width+"px"}),t(i,"range",{step:1,min:0,max:i.size.width,value:0}),i.range.style.top=i.size.height+"px",i.node.appendChild(i.range),i.range.addEventListener("input",function(){n(this.value)})),e.opts.imageSwipe&&(i.sliding=!1,i.container.addEventListener("mousedown",s),i.container.addEventListener("mouseup",o),i.container.addEventListener("mouseleave",o),i.container.addEventListener("mousemove",function(e){a(e,i.sliding)}),i.container.addEventListener("mousedown",function(e){a(e,!0)})),i.node.appendChild(i.separator)})},e.ImageSwiper=function(e){new n(e)}}(this);